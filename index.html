<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>G-PRO ULTRA | PRIVATE V39.1</title>
    <style>
        :root {
            --glass: rgba(255, 255, 255, 0.05);
            --glass-heavy: rgba(255, 255, 255, 0.12);
            --glass-border: rgba(255, 255, 255, 0.15);
            --neon-blue: #00d2ff;
            --neon-green: #39ff14;
            --neon-red: #ff003c;
            --neon-gold: #f59e0b;
        }

        * { box-sizing: border-box; transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); font-family: 'Segoe UI', Tahoma, sans-serif; }
        body { margin: 0; background: #020617; color: #fff; display: flex; min-height: 100vh; overflow-x: hidden; }

        /* Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù…Ù‚ÙÙ„Ø© */
        .full-lock { position: fixed; inset: 0; background: #020617; z-index: 9999; display: flex; align-items: center; justify-content: center; flex-direction: column; }
        
        .sidebar { width: 270px; background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(40px); padding: 25px 15px; height: 100vh; position: fixed; border-left: 1px solid var(--glass-border); z-index: 1000; }
        .logo-box { width: 90px; height: 90px; border-radius: 50%; border: 2px solid var(--neon-blue); margin: 0 auto 15px; overflow: hidden; display: flex; align-items: center; justify-content: center; background: #000; box-shadow: 0 0 15px var(--neon-blue); }
        
        .main-content { margin-right: 270px; padding: 35px; width: calc(100% - 270px); }
        .nav-item { padding: 14px 15px; cursor: pointer; border-radius: 12px; margin-bottom: 8px; display: flex; align-items: center; gap: 10px; color: #94a3b8; font-weight: 600; }
        .nav-item.active { background: var(--glass-heavy); color: var(--neon-blue); border-right: 4px solid var(--neon-blue); }

        .stat-card { background: var(--glass); padding: 12px 20px; border-radius: 15px; border: 1px solid var(--glass-border); font-weight: 800; cursor: pointer; border-bottom: 3px solid transparent; }
        .stat-card.active-filter { border-bottom-color: var(--neon-blue); background: var(--glass-heavy); }

        .date-time-container { background: var(--glass-heavy); padding: 10px 20px; border-radius: 18px; border: 1px solid var(--neon-blue); text-align: center; min-width: 270px; }
        #digital-clock { color: var(--neon-blue); font-weight: 900; font-size: 1.3rem; font-family: monospace; }

        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
        .glass-card { background: var(--glass); border: 1px solid var(--glass-border); border-radius: 25px; padding: 20px; text-align: center; position: relative; overflow: hidden; }
        
        button { cursor: pointer; border-radius: 12px; border: none; padding: 12px; width: 100%; font-weight: 800; margin-top: 10px; }
        .btn-blue { background: var(--neon-blue); color: #000; }
        .btn-green { background: var(--neon-green); color: #000; }
        .btn-red { background: var(--neon-red); color: #fff; }

        input, select { background: rgba(255,255,255,0.08); border: 1px solid var(--glass-border); color: #fff; padding: 12px; border-radius: 10px; width: 100%; margin-bottom: 10px; outline: none; text-align: center; }
        
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); backdrop-filter: blur(20px); z-index: 10001; align-items: center; justify-content: center; }
        .modal-content { background: #0f172a; padding: 30px; border-radius: 25px; width: 420px; border: 1px solid var(--neon-blue); text-align: center; }

        #toast-container { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); z-index: 20000; pointer-events: none; }
        .toast { background: var(--neon-green); color: #000; padding: 12px 30px; border-radius: 50px; font-weight: 900; margin-top: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
        .hidden { display: none !important; }
        .hwid-box { background: #000; padding: 10px; border-radius: 10px; border: 1px solid var(--neon-blue); margin: 15px 0; font-family: monospace; color: var(--neon-blue); cursor: pointer; }
    </style>
</head>
<body>

    <div id="toast-container"></div>

    <div id="license-screen" class="full-lock hidden">
        <div class="modal-content" style="border-color: var(--neon-red);">
            <h2 style="color: var(--neon-red);">ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù†Ø³Ø®Ø© ğŸ”’</h2>
            <p>Ù‡Ø°Ù‡ Ø§Ù„Ù†Ø³Ø®Ø© ØºÙŠØ± Ù…ÙØ¹Ù„Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ø¬Ù‡Ø§Ø²ØŒ Ø§Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯ ÙˆØ£Ø±Ø³Ù„Ù‡ Ù„Ù„Ù…Ø·ÙˆØ±:</p>
            <div id="hwid-display" class="hwid-box" onclick="copyHWID()">--</div>
            <input type="text" id="license-key" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„ Ù‡Ù†Ø§">
            <button class="btn-green" onclick="activateSystem()">ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¢Ù†</button>
        </div>
    </div>

    <div id="login-screen" class="full-lock">
        <div class="modal-content">
            <h1 style="color:var(--neon-blue)">G-PRO LOGIN</h1>
            <select id="user-select"></select>
            <input type="password" id="user-pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±">
            <button class="btn-blue" onclick="attemptLogin()">Ø¯Ø®ÙˆÙ„</button>
        </div>
    </div>

    <div id="shift-screen" class="full-lock hidden">
        <div class="modal-content">
            <h2 style="color:var(--neon-green)">Ø§ÙØªØªØ§Ø­ Ø´ÙØª Ø¬Ø¯ÙŠØ¯</h2>
            <input type="number" id="opening-cash" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„Ø¯Ø±Ø¬">
            <button class="btn-green" onclick="confirmShiftStart()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø§ÙØªØªØ§Ø­</button>
        </div>
    </div>

    <aside class="sidebar">
        <div class="logo-box"><span style="font-size:2.5rem; font-weight:900; color:var(--neon-blue)">G</span></div>
        <h2 id="shop-name-display" style="text-align:center; color:var(--neon-blue)">G-PRO</h2>
        <nav>
            <div class="nav-item active" onclick="switchPage('main', this)">ğŸ–¥ï¸ Ø§Ù„Ø´Ø§Ø´Ø§Øª</div>
            <div class="nav-item" onclick="switchPage('cash', this)">ğŸ’° Ø§Ù„Ø®Ø²ÙŠÙ†Ø©</div>
            <div class="nav-item" onclick="switchPage('reports', this)">ğŸ“œ Ø§Ù„Ø³Ø¬Ù„Ø§Øª</div>
            <div class="nav-item" onclick="switchPage('settings', this)">âš™ï¸ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</div>
            <button class="btn-red" onclick="location.reload()" style="margin-top:20px">Ø®Ø±ÙˆØ¬</button>
        </nav>
    </aside>

    <main class="main-content">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:25px">
            <div style="display:flex; gap:10px">
                <div class="stat-card active-filter" onclick="setFilter('all')">Ø§Ù„ÙƒÙ„: <span id="c-all">0</span></div>
                <div class="stat-card" onclick="setFilter('busy')">Ù„Ø¹Ø¨: <span id="c-busy">0</span></div>
                <div class="stat-card" onclick="setFilter('booked')">Ø­Ø¬Ø²: <span id="c-book">0</span></div>
            </div>
            <div class="date-time-container">
                <div id="digital-clock">00:00:00</div>
                <div id="date-display" style="font-size: 0.8rem; opacity: 0.8;">--/--/----</div>
            </div>
        </div>

        <div id="page-main" class="page"><div class="grid" id="pc-grid"></div></div>

        <div id="page-cash" class="page hidden">
            <div class="glass-card" style="max-width: 400px; margin: auto;">
                <h3>ğŸ’° ÙˆØ¶Ø¹ Ø§Ù„Ø®Ø²ÙŠÙ†Ø©</h3>
                <p>Ø§Ù„Ø§ÙØªØªØ§Ø­ÙŠ: <span id="view-start">0</span></p>
                <p>Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ø´ÙØª: <span id="view-sales">0</span></p>
                <h2 id="view-total" style="color:var(--neon-green)">0</h2>
                <button class="btn-red" onclick="endShift()">Ø¥Ù†Ù‡Ø§Ø¡ ÙˆØ¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø´ÙØª</button>
            </div>
        </div>

        <div id="page-reports" class="page hidden">
            <div class="glass-card">
                <h3>ğŸ“œ Ø³Ø¬Ù„ Ø§Ù„Ø´ÙØªØ§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</h3>
                <table style="width:100%; margin-top:15px; border-collapse: collapse;">
                    <thead><tr style="color:var(--neon-blue)"><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø§Ù„Ù…ÙˆØ¸Ù</th><th>Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</th></tr></thead>
                    <tbody id="logs-table-body"></tbody>
                </table>
            </div>
        </div>

        <div id="page-settings" class="page hidden">
            <div class="grid">
                <div class="glass-card">
                    <h3>ğŸ  Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø­Ù„</h3>
                    <input type="text" id="in-shop-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ù„">
                    <input type="number" id="in-hour-price" placeholder="Ø³Ø¹Ø± Ø§Ù„Ø³Ø§Ø¹Ø©">
                    <button class="btn-blue" onclick="saveSettings()">Ø­ÙØ¸</button>
                </div>
                <div class="glass-card">
                    <h3>ğŸ‘¥ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</h3>
                    <input type="text" id="in-user-name" placeholder="Ø§Ù„Ø§Ø³Ù…">
                    <input type="password" id="in-user-pass" placeholder="Ø§Ù„Ø³Ø±">
                    <button class="btn-green" onclick="addUser()">Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù</button>
                    <div id="user-list-admin" style="margin-top:10px; font-size: 0.9rem;"></div>
                </div>
                <div class="glass-card">
                    <h3>ğŸ” Ø§Ù„Ù…Ù†ÙŠÙˆ</h3>
                    <input type="text" id="in-item-name" placeholder="Ø§Ù„ØµÙ†Ù">
                    <input type="number" id="in-item-price" placeholder="Ø§Ù„Ø³Ø¹Ø±">
                    <button class="btn-blue" onclick="addMenuItem()">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…Ù†ÙŠÙˆ</button>
                    <div id="menu-list-admin" style="margin-top:10px; max-height: 100px; overflow-y: auto;"></div>
                </div>
                <div class="glass-card">
                    <h3>ğŸ–¥ï¸ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©</h3>
                    <button class="btn-green" onclick="addNewPC()">Ø¥Ø¶Ø§ÙØ© Ø´Ø§Ø´Ø© +</button>
                </div>
            </div>
        </div>
    </main>

    <div id="mod-start" class="modal"><div class="modal-content"><h3>Ø¨Ø¯Ø¡ Ù„Ø¹Ø¨ Ø¬Ø¯ÙŠØ¯</h3><input type="text" id="client-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†"><button class="btn-green" onclick="processStart()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†</button><button class="btn-outline" onclick="closeModals()">Ø¥Ù„ØºØ§Ø¡</button></div></div>
    <div id="mod-book" class="modal"><div class="modal-content"><h3>Ø­Ø¬Ø² Ø¬Ù‡Ø§Ø²</h3><input type="text" id="book-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø­Ø§Ø¬Ø²"><button class="btn-red" onclick="processBook()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²</button><button class="btn-outline" onclick="closeModals()">Ø¥Ù„ØºØ§Ø¡</button></div></div>
    <div id="mod-menu" class="modal"><div class="modal-content"><h3>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h3><div id="menu-items-grid" style="display:grid; grid-template-columns:1fr 1fr; gap:10px"></div><button onclick="closeModals()">Ø¥ØºÙ„Ø§Ù‚</button></div></div>
    <div id="mod-invoice" class="modal"><div class="modal-content"><h2>ğŸ§¾ ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø­Ø³Ø§Ø¨</h2><div id="inv-details" style="text-align: right; margin: 15px 0;"></div><h1 id="inv-total" style="color:var(--neon-green)">0</h1><button class="btn-red" id="btn-final-pay">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¯ÙØ¹ ÙˆØ§Ù„Ø¥Ù†Ù‡Ø§Ø¡</button><button onclick="closeModals()">Ø±Ø¬ÙˆØ¹</button></div></div>

    <script>
        const SALT = "GPRO_SECURE_2026_V1";
        
        // ØªÙˆÙ„ÙŠØ¯ Ù…Ø¹Ø±Ù Ø¬Ù‡Ø§Ø² ÙØ±ÙŠØ¯
        function getHWID() {
            let id = window.navigator.userAgent.length + window.navigator.userAgent.replace(/\D+/g, '');
            return "GPRO-" + btoa(id).substring(0, 8).toUpperCase();
        }

        const myID = getHWID();
        let currentFilter = 'all';
        let targetPC = null;

        let db = JSON.parse(localStorage.getItem('GPRO_DATA')) || {
            hwid: myID,
            expiry: "2000-01-01",
            shopName: "G-PRO",
            hourPrice: 25000,
            users: [{u:"Ù…Ø¯ÙŠØ±", p:"123"}],
            pcs: [],
            menu: [],
            logs: [],
            sales: 0,
            drawer: 0,
            shiftOpen: false
        };

        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø­Ù…Ø§ÙŠØ©
        function checkExpiry() {
            if (new Date() > new Date(db.expiry)) {
                document.getElementById('license-screen').classList.remove('hidden');
                document.getElementById('hwid-display').innerText = myID;
                return false;
            }
            return true;
        }

        function activateSystem() {
            let key = document.getElementById('license-key').value.trim();
            try {
                let decoded = atob(key.split('').reverse().join('')).split('|');
                if (decoded[0] === myID && decoded[2] === SALT) {
                    db.expiry = decoded[1]; save(); alert("ØªÙ… Ø§Ù„ØªÙØ¹ÙŠÙ„!"); location.reload();
                } else alert("Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­");
            } catch(e) { alert("ÙƒÙˆØ¯ ØªØ§Ù„Ù"); }
        }

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        function attemptLogin() {
            if(!checkExpiry()) return;
            let u = document.getElementById('user-select').value;
            let p = document.getElementById('user-pass').value;
            let found = db.users.find(x => x.u === u && x.p === p);
            if(found) {
                document.getElementById('login-screen').classList.add('hidden');
                if(!db.shiftOpen) document.getElementById('shift-screen').classList.remove('hidden');
                render();
            } else alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø®Ø·Ø£");
        }

        function confirmShiftStart() {
            db.drawer = parseInt(document.getElementById('opening-cash').value) || 0;
            db.shiftOpen = true;
            document.getElementById('shift-screen').classList.add('hidden');
            save(); toast("ØªÙ… ÙØªØ­ Ø§Ù„Ø´ÙØª Ø¨Ù†Ø¬Ø§Ø­ âœ…");
        }

        // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø´Ø§Ø´Ø§Øª
        function addNewPC() {
            db.pcs.push({id: Date.now(), name: "Ø´Ø§Ø´Ø© " + (db.pcs.length + 1), active: false, booked: false, orders: []});
            save(); toast("ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø´Ø§Ø´Ø© Ø¬Ø¯ÙŠØ¯Ø© âœ…");
        }

        function deletePC(id) {
            if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ø´Ø§Ø´Ø© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ")) {
                db.pcs = db.pcs.filter(x => x.id !== id);
                save(); toast("ØªÙ… Ø­Ø°Ù Ø§Ù„Ø´Ø§Ø´Ø© ğŸ—‘ï¸");
            }
        }

        function openStart(id) { targetPC = id; document.getElementById('mod-start').style.display='flex'; }
        function processStart() {
            let pc = db.pcs.find(x => x.id === targetPC);
            pc.active = true; pc.booked = false; pc.start = Date.now();
            pc.client = document.getElementById('client-name').value || "Ø²Ø¨ÙˆÙ†";
            pc.orders = [];
            closeModals(); save();
        }

        function openBook(id) { targetPC = id; document.getElementById('mod-book').style.display='flex'; }
        function processBook() {
            let pc = db.pcs.find(x => x.id === targetPC);
            pc.booked = true; pc.client = document.getElementById('book-name').value || "Ø­Ø¬Ø²";
            pc.bookStart = Date.now();
            closeModals(); save();
        }

        function openMenu(id) {
            targetPC = id;
            let list = document.getElementById('menu-items-grid');
            list.innerHTML = db.menu.map(m => `<button class="btn-blue" onclick="addOrder(${m.id})">${m.name}<br>${m.price}</button>`).join('');
            document.getElementById('mod-menu').style.display='flex';
        }

        function addOrder(mid) {
            let pc = db.pcs.find(x => x.id === targetPC);
            let item = db.menu.find(x => x.id === mid);
            pc.orders.push(item);
            save(); toast("ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ù„Ø¨ âœ…");
        }

        function openInvoice(id) {
            let pc = db.pcs.find(x => x.id === id);
            let mins = Math.ceil((Date.now() - pc.start) / 60000);
            let playCost = Math.round(mins * (db.hourPrice / 60));
            let menuCost = pc.orders.reduce((a, b) => a + b.price, 0);
            let total = playCost + menuCost;

            document.getElementById('inv-details').innerHTML = `
                Ø§Ù„Ø¬Ù‡Ø§Ø²: ${pc.name}<br>Ø§Ù„Ø²Ø¨ÙˆÙ†: ${pc.client}<br>
                ÙˆÙ‚Øª Ø§Ù„Ù„Ø¹Ø¨: ${mins} Ø¯Ù‚ÙŠÙ‚Ø© (${playCost} Ù„.Ø³)<br>
                Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ù†ÙŠÙˆ: ${menuCost} Ù„.Ø³
            `;
            document.getElementById('inv-total').innerText = total + " Ù„.Ø³";
            document.getElementById('btn-final-pay').onclick = () => {
                db.sales += total; pc.active = false; pc.orders = [];
                closeModals(); save(); toast("ØªÙ…Øª Ø§Ù„ØªØµÙÙŠØ© Ø¨Ù†Ø¬Ø§Ø­ ğŸ’°");
            };
            document.getElementById('mod-invoice').style.display='flex';
        }

        // Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¹Ø§Ù…Ø©
        function save() { localStorage.setItem('GPRO_DATA', JSON.stringify(db)); render(); }
        
        function render() {
            document.getElementById('user-select').innerHTML = db.users.map(u => `<option>${u.u}</option>`).join('');
            document.getElementById('shop-name-display').innerText = db.shopName;
            document.getElementById('view-start').innerText = db.drawer.toLocaleString();
            document.getElementById('view-sales').innerText = db.sales.toLocaleString();
            document.getElementById('view-total').innerText = (db.drawer + db.sales).toLocaleString();
            
            // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
            document.getElementById('c-all').innerText = db.pcs.length;
            document.getElementById('c-busy').innerText = db.pcs.filter(x => x.active).length;
            document.getElementById('c-book').innerText = db.pcs.filter(x => x.booked).length;

            // Ø±Ù†Ø¯Ø± Ø§Ù„Ø´Ø§Ø´Ø§Øª
            let filtered = db.pcs.filter(p => {
                if(currentFilter === 'busy') return p.active;
                if(currentFilter === 'booked') return p.booked;
                return true;
            });

            document.getElementById('pc-grid').innerHTML = filtered.map(p => `
                <div class="glass-card" style="border-top: 4px solid ${p.active ? 'var(--neon-green)' : (p.booked ? 'var(--neon-gold)' : 'var(--neon-blue)')}">
                    <button onclick="deletePC(${p.id})" style="position:absolute; top:5px; right:10px; width:20px; background:none; color:red">Ã—</button>
                    <b style="font-size:1.2rem">${p.name}</b><br>
                    <small>${p.active ? p.client : (p.booked ? 'Ø­Ø¬Ø²: ' + p.client : 'Ù…ØªØ§Ø­')}</small>
                    <div id="time-${p.id}" style="font-size:1.8rem; margin:15px 0; font-family:monospace">00:00:00</div>
                    <div style="display:flex; gap:5px">
                        ${p.active ? 
                            `<button class="btn-blue" onclick="openMenu(${p.id})">ğŸ”</button><button class="btn-red" onclick="openInvoice(${p.id})">ØªØµÙÙŠØ©</button>` : 
                            `<button class="btn-green" onclick="openStart(${p.id})">${p.booked ? 'ØªÙØ¹ÙŠÙ„' : 'Ø¨Ø¯Ø¡'}</button>${!p.booked ? `<button class="btn-red" style="background:#4b1d1d" onclick="openBook(${p.id})">Ø­Ø¬Ø²</button>` : ''}`
                        }
                    </div>
                </div>
            `).join('');

            // Ø±Ù†Ø¯Ø± Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
            document.getElementById('user-list-admin').innerHTML = db.users.map(u => `<div>ğŸ‘¤ ${u.u} <button onclick="db.users=db.users.filter(x=>x.u!=='${u.u}');save()" style="width:20px; padding:0; background:none; color:red">Ã—</button></div>`).join('');
            document.getElementById('menu-list-admin').innerHTML = db.menu.map(m => `<div>ğŸ´ ${m.name} (${m.price}) <button onclick="db.menu=db.menu.filter(x=>x.id!==${m.id});save()" style="width:20px; padding:0; background:none; color:red">Ã—</button></div>`).join('');
            document.getElementById('logs-table-body').innerHTML = db.logs.map(l => `<tr><td>${l.date}</td><td>${l.user}</td><td>${l.sales}</td></tr>`).join('');
        }

        // Ø§Ù„ÙˆÙ‚Øª ÙˆØ§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª
        setInterval(() => {
            let now = new Date();
            document.getElementById('digital-clock').innerText = now.toLocaleTimeString();
            document.getElementById('date-display').innerText = now.toLocaleDateString();

            db.pcs.forEach(p => {
                let el = document.getElementById(`time-${p.id}`);
                if(!el) return;
                if(p.active) {
                    let diff = Math.floor((Date.now() - p.start) / 1000);
                    let h = Math.floor(diff / 3600), m = Math.floor((diff % 3600) / 60), s = diff % 60;
                    el.innerText = `${h}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
                } else if(p.booked) {
                    let remain = (30 * 60 * 1000) - (Date.now() - p.bookStart);
                    if(remain <= 0) { p.booked = false; save(); toast("Ø§Ù†ØªÙ‡Ù‰ ÙˆÙ‚Øª Ø­Ø¬Ø² Ø¥Ø­Ø¯Ù‰ Ø§Ù„Ø´Ø§Ø´Ø§Øª âš ï¸"); }
                    else {
                        let m = Math.floor(remain / 60000), s = Math.floor((remain % 60000) / 1000);
                        el.innerText = `00:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
                        el.style.color = 'var(--neon-gold)';
                    }
                } else { el.innerText = "00:00:00"; el.style.color = "#fff"; }
            });
        }, 1000);

        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        function toast(m) { let t = document.createElement('div'); t.className='toast'; t.innerText=m; document.getElementById('toast-container').appendChild(t); setTimeout(()=>t.remove(),2500); }
        function switchPage(p, el) { document.querySelectorAll('.page').forEach(x=>x.classList.add('hidden')); document.getElementById('page-'+p).classList.remove('hidden'); document.querySelectorAll('.nav-item').forEach(x=>x.classList.remove('active')); el.classList.add('active'); }
        function closeModals() { document.querySelectorAll('.modal').forEach(m=>m.style.display='none'); }
        function setFilter(f) { currentFilter = f; render(); }
        function copyHWID() { navigator.clipboard.writeText(myID); toast("ØªÙ… Ù†Ø³Ø® ÙƒÙˆØ¯ Ø§Ù„Ø¬Ù‡Ø§Ø² âœ…"); }
        
        // Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
        function saveSettings() { db.shopName = document.getElementById('in-shop-name').value; db.hourPrice = parseInt(document.getElementById('in-hour-price').value); save(); toast("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª âœ…"); }
        function addUser() { db.users.push({u:document.getElementById('in-user-name').value, p:document.getElementById('in-user-pass').value}); save(); }
        function addMenuItem() { db.menu.push({id:Date.now(), name:document.getElementById('in-item-name').value, price:parseInt(document.getElementById('in-item-price').value)}); save(); }
        function endShift() {
            if(confirm("Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø´ÙØªØŸ")) {
                db.logs.push({date: new Date().toLocaleString(), user: "Ù…Ø¯ÙŠØ±", sales: db.sales});
                db.sales = 0; db.shiftOpen = false; save(); location.reload();
            }
        }

        render();
        checkExpiry();
    </script>
</body>
</html>
