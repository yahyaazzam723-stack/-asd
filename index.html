<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>G-PRO ULTRA | BY YAHYA.EXE.V1</title>
    <style>
        /* --- Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª ÙˆØ§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¹Ø§Ù… --- */
        :root { 
            --glass: rgba(255, 255, 255, 0.05); 
            --glass-heavy: rgba(255, 255, 255, 0.12); 
            --glass-border: rgba(255, 255, 255, 0.15); 
            --neon-blue: #00d2ff; 
            --neon-green: #39ff14; 
            --neon-red: #ff003c; 
            --neon-gold: #f59e0b; 
        }
        
        * { box-sizing: border-box; transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); font-family: 'Segoe UI', Tahoma, sans-serif; }
        body { margin: 0; background: #020617; color: #fff; display: flex; min-height: 100vh; overflow-x: hidden; }

        /* Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù…Ù‚ÙÙ„Ø© */
        .full-lock { position: fixed; inset: 0; background: #020617; z-index: 99999; display: flex; align-items: center; justify-content: center; }
        .yahya-card { background: #0f172a; padding: 35px; border-radius: 30px; border: 2px solid var(--neon-gold); width: 400px; text-align: center; box-shadow: 0 0 50px rgba(245, 158, 11, 0.2); }
        
        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© */
        .sidebar { width: 270px; background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(40px); padding: 25px 15px; height: 100vh; position: fixed; border-left: 1px solid var(--glass-border); z-index: 1000; }
        .logo-box { width: 90px; height: 90px; border-radius: 50%; border: 2px solid var(--neon-blue); margin: 0 auto 10px; overflow: hidden; display: flex; align-items: center; justify-content: center; background: #000; box-shadow: 0 0 15px var(--neon-blue); }
        .logo-box img { width: 100%; height: 100%; object-fit: cover; }
        
        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø®Ø§ØµØ© Ø¨ÙŠØ­ÙŠÙ‰ */
        .dev-contact-btn { display: block; width: 100%; padding: 12px; margin-top: 10px; border-radius: 12px; text-decoration: none; text-align: center; font-weight: 800; font-size: 0.9rem; border: 1px solid transparent; }
        .btn-wa { background: rgba(37, 211, 102, 0.15); color: #25D366; border-color: rgba(37, 211, 102, 0.3); }
        .btn-wa:hover { background: #25D366; color: #000; box-shadow: 0 0 15px #25D366; }
        .btn-ig { background: rgba(225, 48, 108, 0.15); color: #E1306C; border-color: rgba(225, 48, 108, 0.3); }
        .btn-ig:hover { background: #E1306C; color: #fff; box-shadow: 0 0 15px #E1306C; }

        /* Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        .main-content { margin-right: 270px; padding: 35px; width: calc(100% - 270px); }
        .nav-item { padding: 14px 15px; cursor: pointer; border-radius: 12px; margin-bottom: 8px; display: flex; align-items: center; gap: 10px; color: #94a3b8; font-weight: 600; }
        .nav-item.active { background: var(--glass-heavy); color: var(--neon-blue); border-right: 4px solid var(--neon-blue); }
        
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
        .glass-card { background: var(--glass); border: 1px solid var(--glass-border); border-radius: 25px; padding: 20px; text-align: center; position: relative; }
        
        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ§Ù„Ø¹Ù†Ø§ØµØ± */
        button { cursor: pointer; border-radius: 12px; border: none; padding: 12px; width: 100%; font-weight: 800; margin-top: 10px; }
        .btn-blue { background: var(--neon-blue); color: #000; }
        .btn-green { background: var(--neon-green); color: #000; }
        .btn-red { background: var(--neon-red); color: #fff; }
        input, select { background: rgba(255,255,255,0.08); border: 1px solid var(--glass-border); color: #fff; padding: 12px; border-radius: 10px; width: 100%; margin-bottom: 10px; outline: none; }
        
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); backdrop-filter: blur(20px); z-index: 10001; align-items: center; justify-content: center; }
        .modal-content { background: #0f172a; padding: 30px; border-radius: 25px; width: 420px; border: 1px solid var(--neon-blue); text-align: center; }
        
        .hidden { display: none !important; }
        #toast-container { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); z-index: 20000; pointer-events: none; }
        .toast { background: var(--neon-green); color: #000; padding: 12px 30px; border-radius: 50px; font-weight: 900; margin-top: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
        
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { padding: 10px; border-bottom: 1px solid var(--glass-border); text-align: center; }
    </style>
</head>
<body>

    <div id="yahya-lock-screen" class="full-lock">
        <div class="yahya-card">
            <h1 style="color:var(--neon-gold)">YAHYA G-PRO</h1>
            <p id="yahya-status">Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ØªÙØ¹ÙŠÙ„...</p>
            <input type="text" id="yahya-key-input" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„">
            <button class="btn-green" id="btnActivate">ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù†Ø¸Ø§Ù… âœ…</button>
            <hr style="opacity:0.1; margin: 15px 0;">
            <small style="color:var(--neon-blue)">Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ÙƒÙˆØ¯ØŸ ØªÙˆØ§ØµÙ„ Ù…Ø¹ ÙŠØ­ÙŠÙ‰</small>
        </div>
    </div>

    <div id="login-screen" class="full-lock hidden">
        <div class="modal-content">
            <h1 style="color:var(--neon-blue)">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h1>
            <select id="login-u-list"></select>
            <input type="password" id="login-p" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±">
            <button class="btn-blue" onclick="handleLogin()">Ø¯Ø®ÙˆÙ„</button>
        </div>
    </div>

    <aside class="sidebar">
        <div class="logo-box">
            <img id="side-logo-img" style="display:none">
            <span id="logo-text" style="font-size:2.5rem; font-weight:900; color:var(--neon-blue)">G</span>
        </div>
        <h2 id="shop-name-side" style="text-align:center; color:var(--neon-blue); margin:0">G-PRO</h2>
        <div id="sub-timer-display" style="text-align:center; font-size:0.7rem; color:var(--neon-gold); margin:10px 0; display:none;"></div>
        
        <nav>
            <div class="nav-item active" onclick="showPage('main', this)">ğŸ–¥ï¸ Ø§Ù„Ø´Ø§Ø´Ø§Øª</div>
            <div class="nav-item" onclick="showPage('cash', this)">ğŸ’° Ø§Ù„Ø®Ø²ÙŠÙ†Ø©</div>
            <div class="nav-item" onclick="showPage('reports', this)">ğŸ“œ Ø§Ù„Ø³Ø¬Ù„Ø§Øª</div>
            <div class="nav-item" id="nav-admin" onclick="showPage('settings', this)">âš™ï¸ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</div>
            
            <hr style="opacity:0.1; margin: 20px 0;">
            
            <a href="https://wa.me/966546083283" target="_blank" class="dev-contact-btn btn-wa">WhatsApp</a>
            <a href="https://www.instagram.com/yahya.exe.v1/" target="_blank" class="dev-contact-btn btn-ig">Instagram</a>

            <button class="btn-red" onclick="location.reload()" style="margin-top:20px">Ø®Ø±ÙˆØ¬ ğŸ”’</button>
        </nav>
    </aside>

    <main class="main-content">
        <div id="toast-container"></div>
        
        <div class="header-top" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:25px">
            <h1 id="page-title">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h1>
            <div style="background:var(--glass-heavy); padding:10px 20px; border-radius:15px; border:1px solid var(--neon-blue)">
                <div id="digital-clock" style="font-family:monospace; font-size:1.5rem; color:var(--neon-blue)">00:00:00</div>
            </div>
        </div>

        <div id="main-page" class="page"><div class="grid" id="pc-grid"></div></div>

        <div id="cash-page" class="page hidden">
            <div class="glass-card">
                <h3>ğŸ’° Ø­Ø§Ù„Ø© Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚</h3>
                <h2 id="total-drawer-view" style="color:var(--neon-green)">0</h2>
                <button class="btn-red" onclick="closeShift()">Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø´ÙØª</button>
            </div>
        </div>

        <div id="reports-page" class="page hidden">
            <div class="glass-card">
                <h3>ğŸ“œ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</h3>
                <table id="reports-table">
                    <thead><tr><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø§Ù„Ù…ÙˆØ¸Ù</th><th>Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</th></tr></thead>
                    <tbody id="shift-logs-body"></tbody>
                </table>
            </div>
        </div>

        <div id="settings-page" class="page hidden">
            <div class="grid">
                <div class="glass-card">
                    <h3>ğŸ‘¥ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</h3>
                    <input type="text" id="staff-name" placeholder="Ø§Ù„Ø§Ø³Ù…">
                    <input type="password" id="staff-pass" placeholder="Ø§Ù„Ø³Ø±">
                    <button class="btn-green" onclick="addStaff()">Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù</button>
                </div>
                <div class="glass-card">
                    <h3>ğŸ–¥ï¸ Ø§Ù„Ø´Ø§Ø´Ø§Øª</h3>
                    <button class="btn-blue" onclick="addNewPC()">Ø¥Ø¶Ø§ÙØ© Ø´Ø§Ø´Ø© Ø¬Ø¯ÙŠØ¯Ø© +</button>
                </div>
            </div>
        </div>
    </main>

    <div id="modal-start" class="modal"><div class="modal-content"><h3>Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„</h3><input type="text" id="c-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†"><button class="btn-green" onclick="confirmStart()">Ø¨Ø¯Ø¡</button><button onclick="closeModal('modal-start')">Ø¥Ù„ØºØ§Ø¡</button></div></div>
    <div id="modal-invoice" class="modal"><div class="modal-content"><h2>ØªØµÙÙŠØ© Ø§Ù„Ø­Ø³Ø§Ø¨</h2><div id="invoice-data"></div><button class="btn-red" id="confirm-finish-btn">Ø¥Ù†Ù‡Ø§Ø¡</button></div></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, query, where, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        
        const firebaseConfig = { apiKey: "AIzaSyCgkVly9SjQc5ZCeVVmWayhovnIZ7twJOE", authDomain: "gamerprorequests.firebaseapp.com", projectId: "gamerprorequests", storageBucket: "gamerprorequests.firebasestorage.app", messagingSenderId: "1051539622855", appId: "1:1051539622855:web:02179abd0152ae4e8527e2" };
        const app = initializeApp(firebaseConfig); 
        const dbFs = getFirestore(app);

        window.checkSubscription = (inputKey) => {
            const q = query(collection(dbFs, "active_keys"), where("key", "==", inputKey));
            onSnapshot(q, (snap) => {
                if (!snap.empty) {
                    localStorage.setItem('YAHYA_GPRO_KEY', inputKey);
                    document.getElementById('yahya-lock-screen').style.display = 'none';
                    document.getElementById('login-screen').classList.remove('hidden');
                } else {
                    alert("ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­!");
                }
            });
        };
        const savedKey = localStorage.getItem('YAHYA_GPRO_KEY'); if(savedKey) window.checkSubscription(savedKey);
        document.getElementById('btnActivate').onclick = () => window.checkSubscription(document.getElementById('yahya-key-input').value);
    </script>

    <script>
        let db = JSON.parse(localStorage.getItem('GPRO_V41')) || {
            shop: { name: "G-PRO", logo: "" }, staff: [{u: "Ù…Ø¯ÙŠØ±", p: "123"}],
            devices: [], currentSales: 0, shiftLogs: [], defPrice: 20000
        };
        let actionTarget = null;

        function save() { localStorage.setItem('GPRO_V41', JSON.stringify(db)); render(); }

        function render() {
            document.getElementById('login-u-list').innerHTML = db.staff.map(s => `<option value="${s.u}">${s.u}</option>`).join('');
            document.getElementById('total-drawer-view').innerText = db.currentSales.toLocaleString() + " Ù„.Ø³";
            document.getElementById('pc-grid').innerHTML = db.devices.map(d => `
                <div class="glass-card" style="border-top:3px solid ${d.active?'var(--neon-green)':'var(--neon-blue)'}">
                    <b>${d.name}</b><br><small>${d.active ? d.client : 'Ù…ØªØ§Ø­'}</small>
                    <div id="t-${d.id}" style="font-size:1.5rem; margin:10px 0">00:00:00</div>
                    ${d.active ? `<button class="btn-red" onclick="stopSession(${d.id})">ØªØµÙÙŠØ©</button>` : `<button class="btn-green" onclick="openStart(${d.id})">Ø¨Ø¯Ø¡</button>`}
                </div>`).join('');
        }

        window.handleLogin = () => {
            let u = document.getElementById('login-u-list').value, p = document.getElementById('login-p').value;
            if(db.staff.find(s=>s.u===u && s.p===p)) { document.getElementById('login-screen').classList.add('hidden'); render(); } else alert("Ø®Ø·Ø£!");
        };

        window.showPage = (p, btn) => {
            document.querySelectorAll('.page').forEach(x=>x.classList.add('hidden'));
            document.getElementById(p+'-page').classList.remove('hidden');
            document.querySelectorAll('.nav-item').forEach(x=>x.classList.remove('active'));
            btn.classList.add('active');
        };

        window.addNewPC = () => { db.devices.push({id:Date.now(), name:"Ø´Ø§Ø´Ø© "+(db.devices.length+1), active:false}); save(); };
        window.openStart = (id) => { actionTarget=id; document.getElementById('modal-start').style.display='flex'; };
        window.closeModal = (id) => document.getElementById(id).style.display='none';

        window.confirmStart = () => {
            let d = db.devices.find(x=>x.id===actionTarget);
            d.active=true; d.client=document.getElementById('c-name').value || "Ø²Ø¨ÙˆÙ†"; d.start=Date.now();
            closeModal('modal-start'); save();
        };

        window.stopSession = (id) => {
            let d = db.devices.find(x=>x.id===id);
            let mins = (Date.now() - d.start) / 60000;
            let cost = Math.round((mins * db.defPrice) / 60);
            document.getElementById('invoice-data').innerHTML = `Ø§Ù„ÙˆÙ‚Øª: ${Math.ceil(mins)} Ø¯Ù‚ÙŠÙ‚Ø©<br>Ø§Ù„Ø­Ø³Ø§Ø¨: ${cost} Ù„.Ø³`;
            document.getElementById('confirm-finish-btn').onclick = () => {
                db.currentSales += cost; d.active = false; closeModal('modal-invoice'); save();
            };
            document.getElementById('modal-invoice').style.display='flex';
        };

        window.addStaff = () => {
            let u=document.getElementById('staff-name').value, p=document.getElementById('staff-pass').value;
            if(u && p) { db.staff.push({u, p}); save(); }
        };

        setInterval(() => {
            document.getElementById('digital-clock').innerText = new Date().toLocaleTimeString('ar-EG');
            db.devices.forEach(d => {
                if(d.active) {
                    let diff = Date.now() - d.start;
                    let h = Math.floor(diff/3600000), m = Math.floor((diff%3600000)/60000), s = Math.floor((diff%60000)/1000);
                    let el = document.getElementById('t-'+d.id);
                    if(el) el.innerText = `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
                }
            });
        }, 1000);

        render();
    </script>
</body>
</html>
